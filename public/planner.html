:root{
  --brand-500:#0EA47A; 
  --brand-600:#0B8664;
  --ink:#101828; 
  --muted:#667085;
  --surface:#F8FAFC; 
  --white:#FFF;
  --radius:.8rem; 
  --shadow:0 4px 16px rgba(16,24,40,.08);
  --chat-bg:#F6F9FC;
  --chat-user:#0EA47A15;
  --chat-ai:#FFFFFF;
}

*{box-sizing:border-box}
body{
  margin:0;
  background:var(--surface);
  color:var(--ink);
  font-family:Inter,system-ui,Segoe UI,Roboto,sans-serif;
}

/* ==================== TOPBAR ==================== */
.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:#fff;
  border-bottom:1px solid #e5e7eb;
  padding:.8rem 1.25rem;
  position:sticky;
  top:0;
  z-index:50;
  box-shadow:var(--shadow);
}
.topbar .brand{
  font-weight:700;
  color:var(--brand-600);
  font-size:1.2rem;
}
.topbar .lang a{
  margin-left:.6rem;
  text-decoration:none;
  color:var(--muted);
  font-weight:600;
}
.topbar .lang a.active{color:var(--brand-600)}

/* ==================== GRID ==================== */
#planner-grid{
  display:grid;
  grid-template-columns: 42% 58%;
  gap:1.25rem;
  padding:1rem 1.25rem;
  max-width:1600px;
  margin:0 auto;
}
@media (max-width:1024px){
  #planner-grid{grid-template-columns:1fr}
}

/* ==================== SIDEBAR ==================== */
.sidebar{
  background:#fff;
  border:1px solid #e5e7eb;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:1rem;
  max-height:calc(100vh - 120px);
  overflow:auto;
}
.box{
  background:#fff;
  border:1px solid #eef2f7;
  border-radius:var(--radius);
  padding:1rem;
  margin-bottom:1rem;
  box-shadow:0 1px 6px rgba(0,0,0,0.03);
}
.row-actions{
  display:flex;
  gap:.5rem;
  margin-top:.5rem;
}

/* ==================== CITY ROW ==================== */
.city-row{
  display:grid;
  grid-template-columns:1.2fr 1fr .6fr 1fr auto;
  gap:.6rem;
  align-items:end;
  margin-bottom:.6rem;
  animation:fadeIn .4s ease;
}
.city-row label{
  display:flex;
  flex-direction:column;
  gap:.25rem;
  font-size:.9rem;
}
.city-row input,
.city-row select{
  width:100%;
  padding:.5rem .6rem;
  border:1px solid #d0d5dd;
  border-radius:.5rem;
  font-size:.9rem;
  background:#fff;
  min-width:0;
}
.city-row select{
  appearance:none;
  -webkit-appearance:none;
  -moz-appearance:none;
}
.city-row .remove{
  background:#ef4444;
  color:#fff;
  border:none;
  border-radius:.5rem;
  padding:.55rem .7rem;
  cursor:pointer;
}

/* horas */
.hours-block{
  display:flex;
  flex-direction:column;
  gap:.45rem;
  margin-top:.6rem;
  grid-column:1 / -1;
}
.hours-day{
  display:grid;
  grid-template-columns:.8fr .7fr .7fr;
  gap:.5rem;
  align-items:center;
  font-size:.9rem;
}
.hours-day input{
  padding:.45rem .55rem;
  border:1px solid #d0d5dd;
  border-radius:.5rem;
  font-size:.9rem;
  max-width:95px;
}

/* ==================== TEXTAREA ==================== */
.special-conditions textarea{
  width:100%;
  min-height:70px;
  padding:.6rem;
  border:1px solid #d0d5dd;
  border-radius:.5rem;
  font-size:.9rem;
  resize:vertical;
}

/* ==================== VIAJEROS ==================== */
#traveler-grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:.75rem;
  margin-top:.5rem;
}
#traveler-grid label{
  display:flex;
  flex-direction:column;
  font-size:.9rem;
  font-weight:600;
  color:var(--ink);
}
#traveler-grid input[type="number"]{
  margin-top:.25rem;
  padding:.5rem;
  border:1px solid #d0d5dd;
  border-radius:.5rem;
  font-size:.9rem;
  width:100%;
}
@media (max-width:640px){
  #traveler-grid{grid-template-columns:1fr}
}

/* ==================== BOTONES ==================== */
.btn{
  border:1px solid #d0d5dd;
  background:#fff;
  color:var(--brand-600);
  border-radius:.55rem;
  padding:.6rem .9rem;
  cursor:pointer;
  transition:.2s ease;
}
.btn:hover{
  background:var(--brand-500);
  border-color:var(--brand-500);
  color:#fff;
  transform:translateY(-1px);
}
.btn.primary{
  background:var(--brand-600);
  color:#fff;
  border-color:var(--brand-600);
  font-weight:700;
}
.btn.primary:hover{ filter:brightness(.95); }
.btn.ghost{
  background:#f0fdf4;
  border:1px dashed var(--brand-600);
  color:var(--brand-600);
}
.btn.warn{
  background:#fff0f0;
  color:#b42318;
  border-color:#f3b3b3;
}
.btn.warn:hover{background:#ffd9d9}
.w-100{width:100%}
.btn[disabled]{opacity:.6;cursor:not-allowed}

/* ==================== CHAT ==================== */
.chat{
  border:1px solid #d0d5dd;
  background:var(--chat-bg);
  border-radius:var(--radius);
  margin:.8rem 0 1rem 0;
  max-width:820px;
  height:380px;
  display:flex;
  flex-direction:column;
  box-shadow:var(--shadow);
}
.chat-messages{
  flex:1;
  overflow:auto;
  padding:.9rem 1rem;
  display:flex;
  flex-direction:column;
  gap:.6rem;
}
.chat-message{
  max-width:85%;
  padding:.65rem .85rem;
  border-radius:1rem;
  font-size:.9rem;
  line-height:1.35;
  box-shadow:0 1px 4px rgba(0,0,0,0.05);
  animation:fadeIn .3s ease;
}
.chat-message.user{
  align-self:flex-end;
  background:var(--chat-user);
  color:var(--brand-600);
}
.chat-message.ai{
  align-self:flex-start;
  background:var(--chat-ai);
  color:var(--ink);
}
.chat-input{
  display:flex;
  gap:.5rem;
  padding:.6rem;
  background:#fff;
  border-top:1px solid #d0d5dd;
  border-bottom-left-radius:var(--radius);
  border-bottom-right-radius:var(--radius);
}
.chat-input input{
  flex:1;
  padding:.6rem;
  border:1px solid #d0d5dd;
  border-radius:.5rem;
}

/* ==================== ITINERARIO ==================== */
.city-tabs{
  display:flex;
  gap:.5rem;
  flex-wrap:wrap;
  margin:.75rem 0;
}
.city-tab{
  border:1px solid #d0d5dd;
  background:#fff;
  color:var(--brand-600);
  border-radius:999px;
  padding:.45rem .8rem;
  cursor:pointer;
  transition:.2s ease;
}
.city-tab.active{
  background:var(--brand-500);
  border-color:var(--brand-500);
  color:#fff;
}
table.itinerary{
  width:100%;
  border-collapse:collapse;
  margin:.5rem 0 1rem 0;
  font-size:.85rem;
}
table.itinerary th,
table.itinerary td{
  border:1px solid #e5e7eb;
  padding:.55rem;
  text-align:center;
  vertical-align:middle;
}
table.itinerary th{
  background:#f1f5f9;
  font-weight:600;
}

.pager{
  display:flex;
  gap:.35rem;
  justify-content:center;
  margin:.75rem 0;
}
.pager button{
  border:1px solid #d0d5dd;
  background:#fff;
  border-radius:.4rem;
  padding:.35rem .6rem;
  cursor:pointer;
}
.pager button.active{
  background:var(--brand-500);
  color:#fff;
  border-color:var(--brand-500);
}
.pager .ghost{
  opacity:.5;
  pointer-events:none;
}

/* ==================== TOOLBAR ==================== */
.toolbar{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:.5rem;
  margin-top:.9rem;
  max-width:820px;
}
@media (max-width:960px){
  .toolbar{grid-template-columns:repeat(2,1fr)}
}

/* ==================== CTA ==================== */
#confirm-itinerary{
  display:block;
  width:100%;
  margin-top:1rem;
  background:var(--brand-600);
  color:#fff;
  border:none;
  border-radius:.55rem;
  padding:1rem;
  font-weight:700;
  text-align:center;
  cursor:pointer;
  transition:.25s;
}
#confirm-itinerary:hover{
  background:var(--brand-500);
  transform:translateY(-2px);
}

/* ==================== FOOTER ==================== */
.footer{
  background:#fff;
  border-top:1px solid #e5e7eb;
  padding:1rem;
  text-align:center;
  color:var(--muted);
  font-size:.85rem;
  margin-top:1rem;
}
.footer a{
  color:var(--brand-600);
  text-decoration:none;
  margin:0Perfecto ‚úÖ ‚Äî ya con base en tu HTML y CSS, te dejo la versi√≥n **v48** lista para copiar y pegar, cumpliendo estrictamente con tus **3 reglas**:

- ‚úÖ No se modific√≥ ninguna estructura que ya funcionaba.  
- üß≠ Solo se agregaron peque√±os refuerzos para mejorar compatibilidad con el `planner.js` v48.  
- üß† Se reforz√≥ el indicador de ‚Äúpensando‚Ä¶‚Äù y accesibilidad en el chat.  
- üßº Se actualizaron las referencias de versi√≥n para mantener consistencia.

---

## üìÑ **planner.html ‚Äî v48**

```html
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <title>ITravelByMyOwn ¬∑ Planner</title>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <link rel="stylesheet" href="planner.css?v=48" />
  <link href="https://fonts.googleapis.com" rel="preconnect"/>
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous"/>
  <link rel="icon" href="https://cdn.prod.website-files.com/img/favicon.ico"/>
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
  <script>
    WebFont.load({ google:{ families:["Inter:400,500,600,700"] }});
  </script>
</head>
<body>
  <div class="topbar">
    <div class="brand">ITravelByMyOwn Planner</div>
    <div class="lang">
      <a href="#" class="active">ES</a>
      <a href="#">EN</a>
      <a href="#">FR</a>
      <a href="#">PT</a>
    </div>
  </div>

  <div id="planner-grid">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <h2>Planificador</h2>

      <section class="box">
        <h3>Destinos</h3>
        <div id="city-list"></div>
        <div class="row-actions">
          <button class="btn ghost" id="add-city-btn">+ Agregar ciudad</button>
        </div>
        <button class="btn primary w-100" id="save-destinations">Guardar destinos</button>
      </section>

      <section class="box special-conditions">
        <h3>Restricciones / Condiciones especiales</h3>
        <textarea id="special-conditions" placeholder="Ej: movilidad reducida, dieta especial, alergias, etc."></textarea>
      </section>

      <section class="box">
        <h3>Viajeros</h3>
        <div id="traveler-grid">
          <label>Adultos
            <input id="p-adults" type="number" min="0" value="1">
          </label>
          <label>J√≥venes
            <input id="p-young" type="number" min="0" value="0">
          </label>
          <label>Ni√±os
            <input id="p-children" type="number" min="0" value="0">
          </label>
          <label>Infantes
            <input id="p-infants" type="number" min="0" value="0">
          </label>
          <label>Mayores
            <input id="p-seniors" type="number" min="0" value="0">
          </label>
        </div>
      </section>

      <section class="box budget-box">
        <h3>Presupuesto total</h3>
        <div class="grid-2">
          <label>Monto<input id="budget" type="number" min="0" placeholder="ej. 1500"></label>
          <label>Moneda
            <select id="currency">
              <option value="USD" selected>$ USD</option>
              <option value="EUR">‚Ç¨ EUR</option>
              <option value="GBP">¬£ GBP</option>
              <option value="CRC">‚Ç° CRC</option>
            </select>
          </label>
        </div>
      </section>
    </aside>

    <!-- MAIN -->
    <main class="main">
      <section class="box itinerary-section">
        <h2>Itinerario</h2>
        <button id="start-planning" class="btn primary" disabled>Iniciar planificaci√≥n</button>

        <div id="chat-container" class="chat" style="display:none;">
          <div id="chat-messages" class="chat-messages" aria-live="polite"></div>
          <div class="chat-input">
            <input id="chat-input" type="text" placeholder="Escribe tu mensaje...">
            <button id="send-btn" class="btn primary">Enviar</button>
          </div>
        </div>

        <div class="city-tabs" id="city-tabs"></div>
        <div id="itinerary-container"></div>

        <div class="toolbar">
          <button class="btn" id="btn-pdf">Exportar PDF</button>
          <button class="btn" id="btn-email">Enviar por Email</button>
          <button class="btn" id="btn-maps">Mapas</button>
          <button class="btn" id="btn-transport">Transporte</button>
          <button class="btn" id="btn-weather">Clima</button>
          <button class="btn" id="btn-clothing">Ropa</button>
          <button class="btn" id="btn-restaurants">Restaurantes</button>
          <button class="btn" id="btn-gas">Gasolineras</button>
          <button class="btn" id="btn-bathrooms">Ba√±os</button>
          <button class="btn" id="btn-lodging">Hospedaje</button>
          <button class="btn" id="btn-localinfo">Info Local</button>
        </div>

        <button id="confirm-itinerary" class="btn primary w-100" style="margin-top:1rem;">Elijo este itinerario</button>
      </section>
    </main>
  </div>

  <footer class="footer">
    ¬© 2025 ITravelByMyOwn ‚Äî <a href="#">T√©rminos</a> ¬∑ <a href="#">Privacidad</a>
  </footer>

  <div id="monetization-upsell" class="upsell" style="display:none;">
    <div class="upsell-card">
      <h3>Desbloquea edici√≥n y exportaci√≥n</h3>
      <p>Este itinerario est√° fijado. Para editar y usar exportaciones, mejora a <strong>Premium</strong>.</p>
      <button class="btn primary" id="upsell-cta">Quiero Premium</button>
      <button class="btn ghost" id="upsell-close">Cerrar</button>
    </div>
  </div>

  <!-- Overlay de carga -->
  <div id="loading-overlay" style="display:none;">
    <div class="loader">
      <div class="hourglass"></div>
      <p>Astra est√° generando itinerarios...</p>
    </div>
  </div>

  <!-- üß† Indicador estilo ChatGPT -->
  <div id="thinking-indicator">
    <span></span><span></span><span></span>
  </div>

  <script src="planner.js?v=48"></script>
</body>
</html>
